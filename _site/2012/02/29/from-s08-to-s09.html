<!DOCTYPE html>

<html>
    <head>
        <meta charset="utf-8"/>
        <meta name="author" content="Dzenan Ridjanovic"/>
        <title>From Spiral08 To Spiral09</title> 
        <link rel="stylesheet" href="/css/code.css"/>  
        <link rel="stylesheet" href="/css/layout.css"/>
        <link rel="stylesheet" href="/css/link.css"/>
        <link rel="stylesheet" href="/css/list.css"/>
        <link rel="stylesheet" href="/css/menu.css"/>
        <link rel="stylesheet" href="/css/page.css"/>
    </head>

    <body>
        <header>  
            <h1>
                <a href="http://www.ondart.info/"><img src="/img/ondartb1.png"/></a>
               From Spiral08 To Spiral09
               <!--  -->
            </h1>
        </header>

        <nav>
            <ul>
                <li>Dart
                    <ul>
                        <li>
                            <a href="http://www.dartlang.org/">Dart</a>
                        </li>
                        <li>
                            <a href="http://try.dartlang.org/">Dart Console</a>
                        </li>
                    </ul>  
                </li>
                <li>Magic Boxes
                    <ul>
                        <li>
                            <a href="http://goo.gl/I72z1">Browse Code</a> 
                        </li>
                        <li>
                            <a href="/mb/spirals/s11/MagicBoxes/MagicBoxes.html">Design Model</a> 
                        </li>
                        <li>
                            <a href="https://github.com/dzenanr/MagicBoxes">Get Git</a> 
                        </li>
                        <li>
                            <a href="https://github.com/dzenanr/MagicBoxes/tags">Get Spirals</a> 
                        </li>
                        <li>
                            <a href="/mb/spirals/s00/MagicBoxes/MagicBoxes.html">Spiral 00</a> 
                        </li>
                        <li>
                            <a href="/mb/spirals/s01/MagicBoxes/MagicBoxes.html">Spiral 01</a> 
                        </li>
                        <li>
                            <a href="/mb/spirals/s02/MagicBoxes/MagicBoxes.html">Spiral 02</a> 
                        </li>
                        <li>
                            <a href="/mb/spirals/s03/MagicBoxes/MagicBoxes.html">Spiral 03</a> 
                        </li>
                        <li>
                            <a href="/mb/spirals/s04/MagicBoxes/MagicBoxes.html">Spiral 04</a> 
                        </li>
                        <li>
                            <a href="/mb/spirals/s05/MagicBoxes/MagicBoxes.html">Spiral 05</a> 
                        </li>
                        <li>
                            <a href="/mb/spirals/s06/MagicBoxes/MagicBoxes.html">Spiral 06</a> 
                        </li>
                        <li>
                            <a href="/mb/spirals/s07/MagicBoxes/MagicBoxes.html">Spiral 07</a> 
                        </li>
                        <li>
                            <a href="/mb/spirals/s08/MagicBoxes/MagicBoxes.html">Spiral 08</a> 
                        </li>
                        <li>
                            <a href="/mb/spirals/s09/MagicBoxes/MagicBoxes.html">Spiral 09</a> 
                        </li>
                        <li>
                            <a href="/mb/spirals/s10/MagicBoxes/MagicBoxes.html">Spiral 10</a> 
                        </li>
                        <li>
                            <a href="/mb/spirals/s11/MagicBoxes/MagicBoxes.html">Spiral 11</a> 
                        </li>
                        <li>
                            <a href="/mb/spirals/s12/MagicBoxes/MagicBoxes.html">Spiral 12</a> 
                        </li>
                    </ul>  
                </li>
                <li>On Dart
                    <ul>
                        <li>
                            <a href="https://plus.google.com/u/0/b/113649577593294551754/113649577593294551754/posts">Google+ Page</a> 
                        </li>
                    </ul>  
                </li>
                <li>Posts
                    <ul>
                        <li>
                            <a href="http://dzenanr.github.com/2012/01/23/from-s00-to-s01.html">From Spiral00 To Spiral01</a> 
                        </li>
                        <li>
                            <a href="http://dzenanr.github.com/2012/01/31/from-s01-to-s02.html">From Spiral01 To Spiral02</a> 
                        </li>
                        <li>
                            <a href="http://dzenanr.github.com/2012/02/02/from-s02-to-s03.html">From Spiral02 To Spiral03</a> 
                        </li>
                        <li>
                            <a href="http://dzenanr.github.com/2012/02/07/from-s03-to-s04.html">From Spiral03 To Spiral04</a> 
                        </li>
                        <li>
                            <a href="http://dzenanr.github.com/2012/02/10/from-s04-to-s05.html">From Spiral04 To Spiral05</a> 
                        </li>
                        <li>
                            <a href="http://dzenanr.github.com/2012/02/15/from-s05-to-s06.html">From Spiral05 To Spiral06</a> 
                        </li>
                        <li>
                            <a href="http://dzenanr.github.com/2012/02/21/from-s06-to-s07.html">From Spiral06 To Spiral07</a> 
                        </li>
                        <li>
                            <a href="http://dzenanr.github.com/2012/02/24/from-s07-to-s08.html">From Spiral07 To Spiral08</a> 
                        </li>
                        <li>
                            <a href="http://dzenanr.github.com/2012/02/29/from-s08-to-s09.html">From Spiral08 To Spiral09</a> 
                        </li>
                        <li>
                            <a href="http://dzenanr.github.com/2012/03/10/from-s09-to-s10.html">From Spiral09 To Spiral10</a> 
                        </li>
                        <li>
                            &nbsp; 
                        </li>
                    </ul>  
                </li>
                <li>About
                    <ul>
                        <li>
                            <a href="http://goo.gl/f1F2e">D. R. (CV in PDF)</a> 
                        </li>
                    </ul>  
                </li>
            </ul>
        </nav>

        <section>
            <h2 id='code'>Code</h2>

<p>The code for the MagicBoxes project is at <a href='https://github.com/dzenanr/MagicBoxes'>MagicBoxes on GitHub</a>. The code for the mb project is at <a href='https://github.com/dzenanr/mb'>mb on GitHub</a>. For teaching or learning purposes, each spiral in MagicBoxes is decomposed into several steps in mb.</p>

<p>The use of the script element in the MagicBoxes.html file has changed from</p>
<div class='highlight'><pre><code class='html'><span class='nt'>&lt;script </span><span class='na'>type=</span><span class='s'>&quot;text/javascript&quot;</span> <span class='na'>src=</span><span class='s'>&quot;MagicBoxes.dart.app.js&quot;</span><span class='nt'>&gt;&lt;/script&gt;</span>
</code></pre>
</div>
<p>to</p>
<div class='highlight'><pre><code class='html'><span class='nt'>&lt;script </span><span class='na'>type=</span><span class='s'>&quot;application/dart&quot;</span> <span class='na'>src=</span><span class='s'>&quot;MagicBoxes.dart&quot;</span><span class='nt'>&gt;&lt;/script&gt;</span>
<span class='nt'>&lt;script</span>
<span class='nt'>  </span><span class='na'>src=</span><span class='s'>&quot;http://dart.googlecode.com/svn/branches/bleeding_edge/dart/client/dart.js&quot;</span><span class='nt'>&gt;</span>
<span class='nt'>&lt;/script&gt;</span>
</code></pre>
</div>
<p>This change requires the Internet access when you run code in the Dart Editor.</p>

<p>If you use Spirals 00 … 11 locally, checkout branches s00a … s11a, where changes have been made.</p>

<h2 id='overview'>Overview</h2>

<p>In Spiral 08, for the last selected box, its title may be changed and an item may be added.</p>

<p>In Spiral 09, line min..max cardinalities may be changed by getting the selected line with a click on the Get button in the tool bar, making changes and setting them with a click on the Set button. Line direction names may be added. A line direction with 1..1 cardinalities may become a part of the identifier of the source concept.</p>

<p>Box sizes may be changed by using the View menu. There are menu items for increasing or decreasing the height, the width and the size of selected boxes.</p>

<p>Even a meta model, as one in Figure 08-09.01, may be designed with this spiral. The meta model represents what the MagicBoxes project tries to accomplish at the data level. Within a domain, there may be multiple models. A model may have several concepts. A concept consists of properties and neighbors. A concept may have several graphical representations (boxes), usually only one. A box may not be related to a concept (the minimum cardinality of zero from Box to Concept). The relationship direction from Concept to Box is named views. A property may have a type, which is a part of the parent domain.</p>

<p><img src='/img/s08s09/MetaModel.png' alt='Alt Figure 08-09.01: Meta model' /></p>

<p><strong>Figure 08-09.01</strong>: Meta model.</p>

<p>In a many-to-many relationship (Figure 08-09.02), between the Course and Student concepts, the third concept is introduced. The Enrollment concept breaks the many-to-many relationship into two one-to-many relationships with named directions. The (user oriented) identifier of the Enrollment concept consists of the two neighbor concepts. All these changes are done by selecting a relationship, getting it in the tool bar, making changes and then setting the relationship.</p>

<p><img src='/img/s08s09/ManyToMany.png' alt='Alt Figure 08-09.02: A many-to-many relationship' /></p>

<p><strong>Figure 08-09.02</strong>: A many-to-many relationship.</p>

<h2 id='steps'>Steps</h2>

<p>The menu bar has six new button elements.</p>

<p><strong>Code 08-09.01</strong>: View menu items.</p>
<div class='highlight'><pre><code class='java'><span class='kd'>class</span> <span class='nc'>MenuBar</span> <span class='o'>{</span>
  <span class='err'>…</span>
  <span class='c1'>// View</span>
  <span class='n'>ButtonElement</span> <span class='n'>increaseSelectionHeightButton</span><span class='o'>;</span>
  <span class='n'>ButtonElement</span> <span class='n'>decreaseSelectionHeightButton</span><span class='o'>;</span>
  <span class='n'>ButtonElement</span> <span class='n'>increaseSelectionWidthButton</span><span class='o'>;</span>
  <span class='n'>ButtonElement</span> <span class='n'>decreaseSelectionWidthButton</span><span class='o'>;</span>
  <span class='n'>ButtonElement</span> <span class='n'>increaseSelectionSizeButton</span><span class='o'>;</span>
  <span class='n'>ButtonElement</span> <span class='n'>decreaseSelectionSizeButton</span><span class='o'>;</span>
</code></pre>
</div>
<p>In the constructor of the MenuBar class, the button elements are initialized by the query method of the document representing the Web page. In addition, their click events are defined by unnamed methods. The reactions to clicks on the buttons are handled by methods in the Board class.</p>

<p><strong>Code 08-09.02</strong>: Reactions to click events of the View menu items.</p>
<div class='highlight'><pre><code class='java'>  <span class='n'>MenuBar</span><span class='o'>(</span><span class='k'>this</span><span class='o'>.</span><span class='na'>board</span><span class='o'>)</span> <span class='o'>{</span>
    <span class='err'>…</span>
    <span class='n'>increaseSelectionHeightButton</span> <span class='o'>=</span> 
      <span class='n'>document</span><span class='o'>.</span><span class='na'>query</span><span class='o'>(</span><span class='err'>&#39;#</span><span class='n'>increase</span><span class='o'>-</span><span class='n'>selection</span><span class='o'>-</span><span class='n'>height</span><span class='err'>&#39;</span><span class='o'>);</span>
    <span class='n'>decreaseSelectionHeightButton</span> <span class='o'>=</span> 
      <span class='n'>document</span><span class='o'>.</span><span class='na'>query</span><span class='o'>(</span><span class='err'>&#39;#</span><span class='n'>decrease</span><span class='o'>-</span><span class='n'>selection</span><span class='o'>-</span><span class='n'>height</span><span class='err'>&#39;</span><span class='o'>);</span>
    <span class='n'>increaseSelectionWidthButton</span> <span class='o'>=</span> 
      <span class='n'>document</span><span class='o'>.</span><span class='na'>query</span><span class='o'>(</span><span class='err'>&#39;#</span><span class='n'>increase</span><span class='o'>-</span><span class='n'>selection</span><span class='o'>-</span><span class='n'>width</span><span class='err'>&#39;</span><span class='o'>);</span>
    <span class='n'>decreaseSelectionWidthButton</span> <span class='o'>=</span> 
      <span class='n'>document</span><span class='o'>.</span><span class='na'>query</span><span class='o'>(</span><span class='err'>&#39;#</span><span class='n'>decrease</span><span class='o'>-</span><span class='n'>selection</span><span class='o'>-</span><span class='n'>width</span><span class='err'>&#39;</span><span class='o'>);</span>
    <span class='n'>increaseSelectionSizeButton</span> <span class='o'>=</span> 
      <span class='n'>document</span><span class='o'>.</span><span class='na'>query</span><span class='o'>(</span><span class='err'>&#39;#</span><span class='n'>increase</span><span class='o'>-</span><span class='n'>selection</span><span class='o'>-</span><span class='n'>size</span><span class='err'>&#39;</span><span class='o'>);</span>
    <span class='n'>decreaseSelectionSizeButton</span> <span class='o'>=</span> 
      <span class='n'>document</span><span class='o'>.</span><span class='na'>query</span><span class='o'>(</span><span class='err'>&#39;#</span><span class='n'>decrease</span><span class='o'>-</span><span class='n'>selection</span><span class='o'>-</span><span class='n'>size</span><span class='err'>&#39;</span><span class='o'>);</span>
    <span class='err'>…</span>
    <span class='c1'>// Menu bar events.</span>
    <span class='err'>…</span>
    <span class='n'>increaseSelectionHeightButton</span><span class='o'>.</span><span class='na'>on</span><span class='o'>.</span><span class='na'>click</span><span class='o'>.</span><span class='na'>add</span><span class='o'>((</span><span class='n'>MouseEvent</span> <span class='n'>e</span><span class='o'>)</span> <span class='o'>{</span>
      <span class='n'>board</span><span class='o'>.</span><span class='na'>increaseHeightOfSelectedBoxes</span><span class='o'>();</span>
    <span class='o'>});</span>
    <span class='n'>decreaseSelectionHeightButton</span><span class='o'>.</span><span class='na'>on</span><span class='o'>.</span><span class='na'>click</span><span class='o'>.</span><span class='na'>add</span><span class='o'>((</span><span class='n'>MouseEvent</span> <span class='n'>e</span><span class='o'>)</span> <span class='o'>{</span>
      <span class='n'>board</span><span class='o'>.</span><span class='na'>decreaseHeightOfSelectedBoxes</span><span class='o'>();</span>
    <span class='o'>});</span>
    <span class='n'>increaseSelectionWidthButton</span><span class='o'>.</span><span class='na'>on</span><span class='o'>.</span><span class='na'>click</span><span class='o'>.</span><span class='na'>add</span><span class='o'>((</span><span class='n'>MouseEvent</span> <span class='n'>e</span><span class='o'>)</span> <span class='o'>{</span>
      <span class='n'>board</span><span class='o'>.</span><span class='na'>increaseWidthOfSelectedBoxes</span><span class='o'>();</span>
    <span class='o'>});</span>
    <span class='n'>decreaseSelectionWidthButton</span><span class='o'>.</span><span class='na'>on</span><span class='o'>.</span><span class='na'>click</span><span class='o'>.</span><span class='na'>add</span><span class='o'>((</span><span class='n'>MouseEvent</span> <span class='n'>e</span><span class='o'>)</span> <span class='o'>{</span>
      <span class='n'>board</span><span class='o'>.</span><span class='na'>decreaseWidthOfSelectedBoxes</span><span class='o'>();</span>
    <span class='o'>});</span>
    <span class='n'>increaseSelectionSizeButton</span><span class='o'>.</span><span class='na'>on</span><span class='o'>.</span><span class='na'>click</span><span class='o'>.</span><span class='na'>add</span><span class='o'>((</span><span class='n'>MouseEvent</span> <span class='n'>e</span><span class='o'>)</span> <span class='o'>{</span>
      <span class='n'>board</span><span class='o'>.</span><span class='na'>increaseSizeOfSelectedBoxes</span><span class='o'>();</span>
    <span class='o'>});</span>
    <span class='n'>decreaseSelectionSizeButton</span><span class='o'>.</span><span class='na'>on</span><span class='o'>.</span><span class='na'>click</span><span class='o'>.</span><span class='na'>add</span><span class='o'>((</span><span class='n'>MouseEvent</span> <span class='n'>e</span><span class='o'>)</span> <span class='o'>{</span>
      <span class='n'>board</span><span class='o'>.</span><span class='na'>decreaseSizeOfSelectedBoxes</span><span class='o'>();</span>
    <span class='o'>});</span>
    <span class='err'>…</span>
  <span class='o'>}</span>
</code></pre>
</div>
<p>Those methods change the size of selected boxes.</p>

<p><strong>Code 08-09.03</strong>: Change size methods of the Board class.</p>
<div class='highlight'><pre><code class='java'>  <span class='kt'>void</span> <span class='nf'>increaseHeightOfSelectedBoxes</span><span class='o'>()</span> <span class='o'>{</span>
    <span class='k'>for</span> <span class='o'>(</span><span class='n'>Box</span> <span class='n'>box</span> <span class='n'>in</span> <span class='n'>boxes</span><span class='o'>)</span> <span class='o'>{</span>
      <span class='k'>if</span> <span class='o'>(</span><span class='n'>box</span><span class='o'>.</span><span class='na'>isSelected</span><span class='o'>())</span> <span class='o'>{</span>
        <span class='n'>box</span><span class='o'>.</span><span class='na'>height</span> <span class='o'>=</span> <span class='n'>box</span><span class='o'>.</span><span class='na'>height</span> <span class='o'>+</span> <span class='n'>Box</span><span class='o'>.</span><span class='na'>DEFAULT_INCREMENT</span><span class='o'>;</span>
      <span class='o'>}</span>
    <span class='o'>}</span>
  <span class='o'>}</span>
  
  <span class='kt'>void</span> <span class='nf'>decreaseHeightOfSelectedBoxes</span><span class='o'>()</span> <span class='o'>{</span>
    <span class='k'>for</span> <span class='o'>(</span><span class='n'>Box</span> <span class='n'>box</span> <span class='n'>in</span> <span class='n'>boxes</span><span class='o'>)</span> <span class='o'>{</span>
      <span class='k'>if</span> <span class='o'>(</span><span class='n'>box</span><span class='o'>.</span><span class='na'>isSelected</span><span class='o'>())</span> <span class='o'>{</span>
        <span class='n'>box</span><span class='o'>.</span><span class='na'>height</span> <span class='o'>=</span> <span class='n'>box</span><span class='o'>.</span><span class='na'>height</span> <span class='o'>-</span> <span class='n'>Box</span><span class='o'>.</span><span class='na'>DEFAULT_INCREMENT</span><span class='o'>;</span>
      <span class='o'>}</span>
    <span class='o'>}</span>
  <span class='o'>}</span>
  
  <span class='kt'>void</span> <span class='nf'>increaseWidthOfSelectedBoxes</span><span class='o'>()</span> <span class='o'>{</span>
    <span class='k'>for</span> <span class='o'>(</span><span class='n'>Box</span> <span class='n'>box</span> <span class='n'>in</span> <span class='n'>boxes</span><span class='o'>)</span> <span class='o'>{</span>
      <span class='k'>if</span> <span class='o'>(</span><span class='n'>box</span><span class='o'>.</span><span class='na'>isSelected</span><span class='o'>())</span> <span class='o'>{</span>
        <span class='n'>box</span><span class='o'>.</span><span class='na'>width</span> <span class='o'>=</span> <span class='n'>box</span><span class='o'>.</span><span class='na'>width</span> <span class='o'>+</span> <span class='n'>Box</span><span class='o'>.</span><span class='na'>DEFAULT_INCREMENT</span><span class='o'>;</span>
      <span class='o'>}</span>
    <span class='o'>}</span>
  <span class='o'>}</span>
  
  <span class='kt'>void</span> <span class='nf'>decreaseWidthOfSelectedBoxes</span><span class='o'>()</span> <span class='o'>{</span>
    <span class='k'>for</span> <span class='o'>(</span><span class='n'>Box</span> <span class='n'>box</span> <span class='n'>in</span> <span class='n'>boxes</span><span class='o'>)</span> <span class='o'>{</span>
      <span class='k'>if</span> <span class='o'>(</span><span class='n'>box</span><span class='o'>.</span><span class='na'>isSelected</span><span class='o'>())</span> <span class='o'>{</span>
        <span class='n'>box</span><span class='o'>.</span><span class='na'>width</span> <span class='o'>=</span> <span class='n'>box</span><span class='o'>.</span><span class='na'>width</span> <span class='o'>-</span> <span class='n'>Box</span><span class='o'>.</span><span class='na'>DEFAULT_INCREMENT</span><span class='o'>;</span>
      <span class='o'>}</span>
    <span class='o'>}</span>
  <span class='o'>}</span>
  
  <span class='kt'>void</span> <span class='nf'>increaseSizeOfSelectedBoxes</span><span class='o'>()</span> <span class='o'>{</span>
    <span class='k'>for</span> <span class='o'>(</span><span class='n'>Box</span> <span class='n'>box</span> <span class='n'>in</span> <span class='n'>boxes</span><span class='o'>)</span> <span class='o'>{</span>
      <span class='k'>if</span> <span class='o'>(</span><span class='n'>box</span><span class='o'>.</span><span class='na'>isSelected</span><span class='o'>())</span> <span class='o'>{</span>
        <span class='n'>box</span><span class='o'>.</span><span class='na'>height</span> <span class='o'>=</span> <span class='n'>box</span><span class='o'>.</span><span class='na'>height</span> <span class='o'>+</span> <span class='n'>Box</span><span class='o'>.</span><span class='na'>DEFAULT_INCREMENT</span><span class='o'>;</span>
        <span class='n'>box</span><span class='o'>.</span><span class='na'>width</span> <span class='o'>=</span> <span class='n'>box</span><span class='o'>.</span><span class='na'>width</span> <span class='o'>+</span> <span class='n'>Box</span><span class='o'>.</span><span class='na'>DEFAULT_INCREMENT</span><span class='o'>;</span>
      <span class='o'>}</span>
    <span class='o'>}</span>
  <span class='o'>}</span>
  
  <span class='kt'>void</span> <span class='nf'>decreaseSizeOfSelectedBoxes</span><span class='o'>()</span> <span class='o'>{</span>
    <span class='k'>for</span> <span class='o'>(</span><span class='n'>Box</span> <span class='n'>box</span> <span class='n'>in</span> <span class='n'>boxes</span><span class='o'>)</span> <span class='o'>{</span>
      <span class='k'>if</span> <span class='o'>(</span><span class='n'>box</span><span class='o'>.</span><span class='na'>isSelected</span><span class='o'>())</span> <span class='o'>{</span>
        <span class='n'>box</span><span class='o'>.</span><span class='na'>height</span> <span class='o'>=</span> <span class='n'>box</span><span class='o'>.</span><span class='na'>height</span> <span class='o'>-</span> <span class='n'>Box</span><span class='o'>.</span><span class='na'>DEFAULT_INCREMENT</span><span class='o'>;</span>
        <span class='n'>box</span><span class='o'>.</span><span class='na'>width</span> <span class='o'>=</span> <span class='n'>box</span><span class='o'>.</span><span class='na'>width</span> <span class='o'>-</span> <span class='n'>Box</span><span class='o'>.</span><span class='na'>DEFAULT_INCREMENT</span><span class='o'>;</span>
      <span class='o'>}</span>
    <span class='o'>}</span>
  <span class='o'>}</span>
</code></pre>
</div>
<p>The incremental change in the size of boxes is defined by the constant in the Box class.</p>

<p><strong>Code 08-09.04</strong>: The box size change constant.</p>
<div class='highlight'><pre><code class='java'><span class='kd'>class</span> <span class='nc'>Box</span> <span class='o'>{</span>
  <span class='err'>…</span>
  <span class='kd'>static</span> <span class='kd'>final</span> <span class='kt'>int</span> <span class='n'>DEFAULT_INCREMENT</span> <span class='o'>=</span> <span class='mi'>20</span><span class='o'>;</span>
</code></pre>
</div>
<p>The button elements with their corresponding ids are added to the View menu of the Web page.</p>

<p><strong>Code 08-09.05</strong>: Menu item buttons in HTML.</p>
<div class='highlight'><pre><code class='html'>       <span class='nt'>&lt;li&gt;</span>View
         <span class='nt'>&lt;ul&gt;</span>
           <span class='nt'>&lt;li&gt;</span>
             <span class='nt'>&lt;button</span> <span class='na'>id=</span><span class='s'>&quot;increase-selection-height&quot;</span><span class='nt'>&gt;</span>
               + Selection height
             <span class='nt'>&lt;/button&gt;</span>
           <span class='nt'>&lt;/li&gt;</span>
           <span class='nt'>&lt;li&gt;</span>
             <span class='nt'>&lt;button</span> <span class='na'>id=</span><span class='s'>&quot;decrease-selection-height&quot;</span><span class='nt'>&gt;</span>
               - Selection height
             <span class='nt'>&lt;/button&gt;</span>
           <span class='nt'>&lt;/li&gt;</span>
           <span class='nt'>&lt;li&gt;</span>
             <span class='nt'>&lt;button</span> <span class='na'>id=</span><span class='s'>&quot;increase-selection-width&quot;</span><span class='nt'>&gt;</span>
               + Selection width
             <span class='nt'>&lt;/button&gt;</span>
           <span class='nt'>&lt;/li&gt;</span>
           <span class='nt'>&lt;li&gt;</span>
             <span class='nt'>&lt;button</span> <span class='na'>id=</span><span class='s'>&quot;decrease-selection-width&quot;</span><span class='nt'>&gt;</span>
               - Selection width
             <span class='nt'>&lt;/button&gt;</span>
           <span class='nt'>&lt;/li&gt;</span>
           <span class='nt'>&lt;li&gt;&lt;button</span> <span class='na'>id=</span><span class='s'>&quot;increase-selection-size&quot;</span><span class='nt'>&gt;</span>
             + Selection size
           <span class='nt'>&lt;/button&gt;</span>
           <span class='nt'>&lt;/li&gt;</span>
           <span class='nt'>&lt;li&gt;</span>
             <span class='nt'>&lt;button</span> <span class='na'>id=</span><span class='s'>&quot;decrease-selection-size&quot;</span><span class='nt'>&gt;</span>
               - Selection size
             <span class='nt'>&lt;/button&gt;</span>
           <span class='nt'>&lt;/li&gt;</span>
</code></pre>
</div>
<p>The Figure 08-09.03 shows three boxes with different sizes.</p>

<p><img src='/img/s08s09/BoxSizes.png' alt='Alt Figure 08-09.03: Boxes with different sizes' /></p>

<p><strong>Figure 08-09.03</strong>: Boxes with different sizes.</p>

<p>There is a small change in the Board class to introduce the canvas attribute and its initialization by the constructor parameter with the same name.</p>

<p><strong>Code 08-09.06</strong>: The canvas attribute.</p>
<div class='highlight'><pre><code class='java'><span class='kd'>class</span> <span class='nc'>Board</span> <span class='o'>{</span>
  <span class='err'>…</span>
  <span class='n'>CanvasElement</span> <span class='n'>canvas</span><span class='o'>;</span>
  <span class='err'>…</span>
  <span class='n'>Board</span><span class='o'>(</span><span class='k'>this</span><span class='o'>.</span><span class='na'>canvas</span><span class='o'>)</span> <span class='o'>{</span>
</code></pre>
</div>
<p>The most recently selected line is kept in the corresponding attribute of the Board class.</p>

<p><strong>Code 08-09.07</strong>: Last line selected attribute.</p>
<div class='highlight'><pre><code class='java'><span class='kd'>class</span> <span class='nc'>Board</span> <span class='o'>{</span>
  <span class='err'>…</span>
  <span class='n'>Line</span> <span class='n'>lastLineSelected</span><span class='o'>;</span>
</code></pre>
</div>
<p>There are new attributes in the Line class for direction names and ids.</p>

<p><strong>Code 08-09.08</strong>: Line direction names and ids.</p>
<div class='highlight'><pre><code class='java'><span class='kd'>class</span> <span class='nc'>Line</span> <span class='o'>{</span>
  <span class='err'>…</span>
  <span class='n'>String</span> <span class='n'>box1box2Name</span><span class='o'>;</span> <span class='c1'>// name from box1 to box2</span>
  <span class='n'>String</span> <span class='n'>box1box2Min</span><span class='o'>;</span> <span class='c1'>// min cardinality from box1 to box2</span>
  <span class='n'>String</span> <span class='n'>box1box2Max</span><span class='o'>;</span> <span class='c1'>// max cardinality from box1 to box2</span>
  <span class='n'>bool</span> <span class='n'>box1box2Id</span><span class='o'>;</span> <span class='c1'>// id from box1 to box2 </span>
  
  <span class='n'>String</span> <span class='n'>box2box1Name</span><span class='o'>;</span> <span class='c1'>// name from box2 to box1</span>
  <span class='n'>String</span> <span class='n'>box2box1Min</span><span class='o'>;</span> <span class='c1'>// min cardinality from box2 to box1</span>
  <span class='n'>String</span> <span class='n'>box2box1Max</span><span class='o'>;</span> <span class='c1'>// max cardinality from box2 to box1</span>
  <span class='n'>bool</span> <span class='n'>box2box1Id</span><span class='o'>;</span> <span class='c1'>// id from box2 to box1</span>
</code></pre>
</div>
<p>The new attributes are initialized in the constructor.</p>

<p><strong>Code 08-09.09</strong>: Default values for the line directions.</p>
<div class='highlight'><pre><code class='java'><span class='n'>Line</span><span class='o'>(</span><span class='k'>this</span><span class='o'>.</span><span class='na'>board</span><span class='o'>,</span> <span class='k'>this</span><span class='o'>.</span><span class='na'>box1</span><span class='o'>,</span> <span class='k'>this</span><span class='o'>.</span><span class='na'>box2</span><span class='o'>)</span> <span class='o'>{</span>
    <span class='n'>box1box2Name</span> <span class='o'>=</span> <span class='err'>&#39;&#39;</span><span class='o'>;</span>
    <span class='n'>box1box2Min</span> <span class='o'>=</span> <span class='sc'>&#39;0&#39;</span><span class='o'>;</span>
    <span class='n'>box1box2Max</span> <span class='o'>=</span> <span class='sc'>&#39;N&#39;</span><span class='o'>;</span>
    <span class='n'>box1box2Id</span> <span class='o'>=</span> <span class='kc'>false</span><span class='o'>;</span>
    <span class='n'>box2box1Name</span> <span class='o'>=</span> <span class='err'>&#39;&#39;</span><span class='o'>;</span>
    <span class='n'>box2box1Min</span> <span class='o'>=</span> <span class='sc'>&#39;1&#39;</span><span class='o'>;</span>
    <span class='n'>box2box1Max</span> <span class='o'>=</span> <span class='sc'>&#39;1&#39;</span><span class='o'>;</span>
    <span class='n'>box2box1Id</span> <span class='o'>=</span> <span class='kc'>false</span><span class='o'>;</span>
    <span class='n'>draw</span><span class='o'>();</span>
    <span class='n'>defaultLineWidth</span> <span class='o'>=</span> <span class='n'>board</span><span class='o'>.</span><span class='na'>context</span><span class='o'>.</span><span class='na'>lineWidth</span><span class='o'>;</span>
  <span class='o'>}</span>
</code></pre>
</div>
<p>In addition to min..max cardinalities, the line direction names and ids are displayed by the draw method of the Line class.</p>

<p><strong>Code 08-09.10</strong>: Drawing line directions.</p>
<div class='highlight'><pre><code class='java'><span class='kt'>void</span> <span class='nf'>draw</span><span class='o'>()</span> <span class='o'>{</span>
    <span class='k'>if</span> <span class='o'>(!</span><span class='n'>isHidden</span><span class='o'>())</span> <span class='o'>{</span>
      <span class='n'>board</span><span class='o'>.</span><span class='na'>context</span><span class='o'>.</span><span class='na'>beginPath</span><span class='o'>();</span>
      <span class='n'>board</span><span class='o'>.</span><span class='na'>context</span><span class='o'>.</span><span class='na'>moveTo</span><span class='o'>(</span><span class='n'>box1</span><span class='o'>.</span><span class='na'>x</span> <span class='o'>+</span> <span class='n'>box1</span><span class='o'>.</span><span class='na'>width</span> <span class='o'>/</span> <span class='mi'>2</span><span class='o'>,</span> <span class='n'>box1</span><span class='o'>.</span><span class='na'>y</span> <span class='o'>+</span> <span class='n'>box1</span><span class='o'>.</span><span class='na'>height</span> <span class='o'>/</span> <span class='mi'>2</span><span class='o'>);</span>
      <span class='n'>board</span><span class='o'>.</span><span class='na'>context</span><span class='o'>.</span><span class='na'>lineTo</span><span class='o'>(</span><span class='n'>box2</span><span class='o'>.</span><span class='na'>x</span> <span class='o'>+</span> <span class='n'>box2</span><span class='o'>.</span><span class='na'>width</span> <span class='o'>/</span> <span class='mi'>2</span><span class='o'>,</span> <span class='n'>box2</span><span class='o'>.</span><span class='na'>y</span> <span class='o'>+</span> <span class='n'>box2</span><span class='o'>.</span><span class='na'>height</span> <span class='o'>/</span> <span class='mi'>2</span><span class='o'>);</span>
      <span class='k'>if</span> <span class='o'>(</span><span class='n'>isSelected</span><span class='o'>())</span> <span class='o'>{</span>
        <span class='n'>board</span><span class='o'>.</span><span class='na'>context</span><span class='o'>.</span><span class='na'>setLineWidth</span><span class='o'>(</span><span class='n'>defaultLineWidth</span> <span class='o'>+</span> <span class='mi'>2</span><span class='o'>);</span>
      <span class='o'>}</span> <span class='k'>else</span> <span class='o'>{</span>
        <span class='n'>board</span><span class='o'>.</span><span class='na'>context</span><span class='o'>.</span><span class='na'>setLineWidth</span><span class='o'>(</span><span class='n'>defaultLineWidth</span><span class='o'>);</span>
      <span class='o'>}</span>
      <span class='n'>Point</span> <span class='n'>box1box2MinMaxPoint</span> <span class='o'>=</span> 
        <span class='n'>calculateMinMaxPointCloseToBeginBox</span><span class='o'>(</span><span class='n'>box1</span><span class='o'>,</span> <span class='n'>box2</span><span class='o'>);</span>
      <span class='n'>Point</span> <span class='n'>box2box1MinMaxPoint</span> <span class='o'>=</span> 
        <span class='n'>calculateMinMaxPointCloseToBeginBox</span><span class='o'>(</span><span class='n'>box2</span><span class='o'>,</span> <span class='n'>box1</span><span class='o'>);</span>
      <span class='n'>Point</span> <span class='n'>box1box2NamePoint</span> <span class='o'>=</span> <span class='n'>calculateNamePointCloseToBeginBox</span><span class='o'>(</span><span class='n'>box1</span><span class='o'>,</span> <span class='n'>box2</span><span class='o'>);</span>
      <span class='n'>Point</span> <span class='n'>box2box1NamePoint</span> <span class='o'>=</span> <span class='n'>calculateNamePointCloseToBeginBox</span><span class='o'>(</span><span class='n'>box2</span><span class='o'>,</span> <span class='n'>box1</span><span class='o'>);</span>
      <span class='n'>String</span> <span class='n'>box1box2MinMax</span> <span class='o'>=</span> <span class='n'>box1box2Min</span> <span class='o'>+</span> <span class='err'>&#39;</span><span class='o'>..</span><span class='err'>&#39;</span> <span class='o'>+</span> <span class='n'>box1box2Max</span><span class='o'>;</span>
      <span class='n'>String</span> <span class='n'>box2box1MinMax</span> <span class='o'>=</span> <span class='n'>box2box1Min</span> <span class='o'>+</span> <span class='err'>&#39;</span><span class='o'>..</span><span class='err'>&#39;</span> <span class='o'>+</span> <span class='n'>box2box1Max</span><span class='o'>;</span>
      <span class='k'>if</span> <span class='o'>(</span><span class='n'>box1box2Id</span><span class='o'>)</span> <span class='o'>{</span>
        <span class='n'>board</span><span class='o'>.</span><span class='na'>context</span><span class='o'>.</span><span class='na'>font</span> <span class='o'>=</span> <span class='err'>&#39;</span><span class='n'>bold</span> <span class='n'>italic</span> <span class='err'>&#39;</span> <span class='o'>+</span> <span class='n'>textFontSize</span> <span class='o'>+</span> <span class='err'>&#39;</span><span class='n'>px</span> <span class='n'>sans</span><span class='o'>-</span><span class='n'>serif</span><span class='err'>&#39;</span><span class='o'>;</span>
      <span class='o'>}</span> <span class='k'>else</span> <span class='k'>if</span> <span class='o'>(</span><span class='n'>box1box2Min</span> <span class='o'>!=</span> <span class='sc'>&#39;0&#39;</span><span class='o'>)</span> <span class='o'>{</span>
        <span class='n'>board</span><span class='o'>.</span><span class='na'>context</span><span class='o'>.</span><span class='na'>font</span> <span class='o'>=</span> <span class='err'>&#39;</span><span class='n'>bold</span> <span class='err'>&#39;</span> <span class='o'>+</span> <span class='n'>textFontSize</span> <span class='o'>+</span> <span class='err'>&#39;</span><span class='n'>px</span> <span class='n'>sans</span><span class='o'>-</span><span class='n'>serif</span><span class='err'>&#39;</span><span class='o'>;</span>
      <span class='o'>}</span> <span class='k'>else</span> <span class='o'>{</span>
        <span class='n'>board</span><span class='o'>.</span><span class='na'>context</span><span class='o'>.</span><span class='na'>font</span> <span class='o'>=</span> <span class='err'>&#39;&#39;</span> <span class='o'>+</span> <span class='n'>textFontSize</span> <span class='o'>+</span> <span class='err'>&#39;</span><span class='n'>px</span> <span class='n'>sans</span><span class='o'>-</span><span class='n'>serif</span><span class='err'>&#39;</span><span class='o'>;</span>
      <span class='o'>}</span>
      <span class='n'>board</span><span class='o'>.</span><span class='na'>context</span><span class='o'>.</span><span class='na'>fillText</span><span class='o'>(</span><span class='n'>box1box2MinMax</span><span class='o'>,</span> <span class='n'>box1box2MinMaxPoint</span><span class='o'>.</span><span class='na'>x</span><span class='o'>,</span> 
        <span class='n'>box1box2MinMaxPoint</span><span class='o'>.</span><span class='na'>y</span><span class='o'>);</span>
      <span class='n'>board</span><span class='o'>.</span><span class='na'>context</span><span class='o'>.</span><span class='na'>fillText</span><span class='o'>(</span><span class='n'>box1box2Name</span><span class='o'>,</span> <span class='n'>box1box2NamePoint</span><span class='o'>.</span><span class='na'>x</span><span class='o'>,</span> 
        <span class='n'>box1box2NamePoint</span><span class='o'>.</span><span class='na'>y</span><span class='o'>);</span>
      <span class='k'>if</span> <span class='o'>(</span><span class='n'>box2box1Id</span><span class='o'>)</span> <span class='o'>{</span>
        <span class='n'>board</span><span class='o'>.</span><span class='na'>context</span><span class='o'>.</span><span class='na'>font</span> <span class='o'>=</span> <span class='err'>&#39;</span><span class='n'>bold</span> <span class='n'>italic</span> <span class='err'>&#39;</span> <span class='o'>+</span> <span class='n'>textFontSize</span> <span class='o'>+</span> <span class='err'>&#39;</span><span class='n'>px</span> <span class='n'>sans</span><span class='o'>-</span><span class='n'>serif</span><span class='err'>&#39;</span><span class='o'>;</span>
      <span class='o'>}</span> <span class='k'>else</span> <span class='k'>if</span> <span class='o'>(</span><span class='n'>box2box1Min</span> <span class='o'>!=</span> <span class='sc'>&#39;0&#39;</span><span class='o'>)</span> <span class='o'>{</span>
        <span class='n'>board</span><span class='o'>.</span><span class='na'>context</span><span class='o'>.</span><span class='na'>font</span> <span class='o'>=</span> <span class='err'>&#39;</span><span class='n'>bold</span> <span class='err'>&#39;</span> <span class='o'>+</span> <span class='n'>textFontSize</span> <span class='o'>+</span> <span class='err'>&#39;</span><span class='n'>px</span> <span class='n'>sans</span><span class='o'>-</span><span class='n'>serif</span><span class='err'>&#39;</span><span class='o'>;</span>
      <span class='o'>}</span> <span class='k'>else</span> <span class='o'>{</span>
        <span class='n'>board</span><span class='o'>.</span><span class='na'>context</span><span class='o'>.</span><span class='na'>font</span> <span class='o'>=</span> <span class='err'>&#39;&#39;</span> <span class='o'>+</span> <span class='n'>textFontSize</span> <span class='o'>+</span> <span class='err'>&#39;</span><span class='n'>px</span> <span class='n'>sans</span><span class='o'>-</span><span class='n'>serif</span><span class='err'>&#39;</span><span class='o'>;</span>
      <span class='o'>}</span>
      <span class='n'>board</span><span class='o'>.</span><span class='na'>context</span><span class='o'>.</span><span class='na'>fillText</span><span class='o'>(</span><span class='n'>box2box1MinMax</span><span class='o'>,</span> <span class='n'>box2box1MinMaxPoint</span><span class='o'>.</span><span class='na'>x</span><span class='o'>,</span> 
        <span class='n'>box2box1MinMaxPoint</span><span class='o'>.</span><span class='na'>y</span><span class='o'>);</span>
      <span class='n'>board</span><span class='o'>.</span><span class='na'>context</span><span class='o'>.</span><span class='na'>fillText</span><span class='o'>(</span><span class='n'>box2box1Name</span><span class='o'>,</span> <span class='n'>box2box1NamePoint</span><span class='o'>.</span><span class='na'>x</span><span class='o'>,</span> 
        <span class='n'>box2box1NamePoint</span><span class='o'>.</span><span class='na'>y</span><span class='o'>);</span>
      <span class='n'>board</span><span class='o'>.</span><span class='na'>context</span><span class='o'>.</span><span class='na'>closePath</span><span class='o'>();</span>
      <span class='n'>board</span><span class='o'>.</span><span class='na'>context</span><span class='o'>.</span><span class='na'>stroke</span><span class='o'>();</span>
    <span class='o'>}</span>
  <span class='o'>}</span>
</code></pre>
</div>
<p>The selection methods of the Line class handle the lastLineSelected attribute of the Board class.</p>

<p><strong>Code 08-09.11</strong>: The last line selected.</p>
<div class='highlight'><pre><code class='java'>  <span class='kt'>void</span> <span class='nf'>select</span><span class='o'>()</span> <span class='o'>{</span>
    <span class='n'>_selected</span> <span class='o'>=</span> <span class='kc'>true</span><span class='o'>;</span>
    <span class='n'>board</span><span class='o'>.</span><span class='na'>lastLineSelected</span> <span class='o'>=</span> <span class='k'>this</span><span class='o'>;</span>
  <span class='o'>}</span>
  
  <span class='kt'>void</span> <span class='nf'>deselect</span><span class='o'>()</span> <span class='o'>{</span>
    <span class='n'>_selected</span> <span class='o'>=</span> <span class='kc'>false</span><span class='o'>;</span>
    <span class='n'>board</span><span class='o'>.</span><span class='na'>lastLineSelected</span> <span class='o'>=</span> <span class='kc'>null</span><span class='o'>;</span>
  <span class='o'>}</span>
  
  <span class='kt'>void</span> <span class='nf'>toggleSelection</span><span class='o'>()</span> <span class='o'>{</span> 
    <span class='n'>_selected</span> <span class='o'>=</span> <span class='o'>!</span><span class='n'>_selected</span><span class='o'>;</span>
    <span class='k'>if</span> <span class='o'>(</span><span class='n'>_selected</span><span class='o'>)</span> <span class='o'>{</span>
      <span class='n'>board</span><span class='o'>.</span><span class='na'>lastLineSelected</span> <span class='o'>=</span> <span class='k'>this</span><span class='o'>;</span>
    <span class='o'>}</span> <span class='k'>else</span> <span class='o'>{</span>
      <span class='n'>board</span><span class='o'>.</span><span class='na'>lastLineSelected</span> <span class='o'>=</span> <span class='kc'>null</span><span class='o'>;</span>
    <span class='o'>}</span>
  <span class='o'>}</span>
</code></pre>
</div>
<p>A line direction name is placed close to its line and the begin box. This location is determined by the calculateNamePointCloseToBeginBox method of the Line class.</p>

<p><strong>Code 08-09.12</strong>: Location for a line direction name.</p>
<div class='highlight'><pre><code class='java'>  <span class='n'>Point</span> <span class='nf'>calculateNamePointCloseToBeginBox</span><span class='o'>(</span><span class='n'>Box</span> <span class='n'>beginBox</span><span class='o'>,</span> <span class='n'>Box</span> <span class='n'>endBox</span><span class='o'>)</span> <span class='o'>{</span>
    <span class='kt'>int</span> <span class='n'>x</span> <span class='o'>=</span> <span class='mi'>0</span><span class='o'>;</span>
    <span class='kt'>int</span> <span class='n'>y</span> <span class='o'>=</span> <span class='mi'>0</span><span class='o'>;</span>
    
    <span class='n'>Point</span> <span class='n'>lineBeginPoint</span> <span class='o'>=</span> <span class='n'>beginBox</span><span class='o'>.</span><span class='na'>center</span><span class='o'>();</span>
    <span class='n'>Point</span> <span class='n'>lineEndPoint</span> <span class='o'>=</span> <span class='n'>endBox</span><span class='o'>.</span><span class='na'>center</span><span class='o'>();</span>
    <span class='n'>Point</span> <span class='n'>beginPoint</span> <span class='o'>=</span> <span class='n'>beginBox</span><span class='o'>.</span><span class='na'>getIntersectionPoint</span><span class='o'>(</span><span class='n'>lineBeginPoint</span><span class='o'>,</span> <span class='n'>lineEndPoint</span><span class='o'>);</span>
    <span class='n'>Point</span> <span class='n'>endPoint</span> <span class='o'>=</span> <span class='n'>endBox</span><span class='o'>.</span><span class='na'>getIntersectionPoint</span><span class='o'>(</span><span class='n'>lineEndPoint</span><span class='o'>,</span> <span class='n'>lineBeginPoint</span><span class='o'>);</span>
    
    <span class='kt'>int</span> <span class='n'>x1</span> <span class='o'>=</span> <span class='n'>beginPoint</span><span class='o'>.</span><span class='na'>x</span><span class='o'>;</span>
    <span class='kt'>int</span> <span class='n'>y1</span> <span class='o'>=</span> <span class='n'>beginPoint</span><span class='o'>.</span><span class='na'>y</span><span class='o'>;</span>
    <span class='kt'>int</span> <span class='n'>x2</span> <span class='o'>=</span> <span class='n'>endPoint</span><span class='o'>.</span><span class='na'>x</span><span class='o'>;</span>
    <span class='kt'>int</span> <span class='n'>y2</span> <span class='o'>=</span> <span class='n'>endPoint</span><span class='o'>.</span><span class='na'>y</span><span class='o'>;</span>
    
    <span class='k'>if</span> <span class='o'>(</span><span class='n'>x1</span> <span class='o'>&lt;=</span> <span class='n'>x2</span><span class='o'>)</span> <span class='o'>{</span>
      <span class='n'>x</span> <span class='o'>=</span> <span class='n'>x1</span> <span class='o'>+</span> <span class='mi'>3</span> <span class='o'>*</span> <span class='o'>((</span><span class='n'>x2</span> <span class='o'>-</span> <span class='n'>x1</span><span class='o'>)</span> <span class='o'>/</span> <span class='mi'>8</span><span class='o'>);</span>
      <span class='k'>if</span> <span class='o'>(</span><span class='n'>y1</span> <span class='o'>&lt;=</span> <span class='n'>y2</span><span class='o'>)</span> <span class='o'>{</span>
          <span class='n'>y</span> <span class='o'>=</span> <span class='n'>y1</span> <span class='o'>+</span> <span class='mi'>3</span> <span class='o'>*</span> <span class='o'>((</span><span class='n'>y2</span> <span class='o'>-</span> <span class='n'>y1</span><span class='o'>)</span> <span class='o'>/</span> <span class='mi'>8</span><span class='o'>);</span>
      <span class='o'>}</span> <span class='k'>else</span> <span class='o'>{</span>
          <span class='n'>y</span> <span class='o'>=</span> <span class='n'>y2</span> <span class='o'>+</span> <span class='mi'>5</span> <span class='o'>*</span> <span class='o'>((</span><span class='n'>y1</span> <span class='o'>-</span> <span class='n'>y2</span><span class='o'>)</span> <span class='o'>/</span> <span class='mi'>8</span><span class='o'>);</span>
      <span class='o'>}</span>
    <span class='o'>}</span> <span class='k'>else</span> <span class='o'>{</span>
      <span class='n'>x</span> <span class='o'>=</span> <span class='n'>x2</span> <span class='o'>+</span> <span class='mi'>5</span> <span class='o'>*</span> <span class='o'>((</span><span class='n'>x1</span> <span class='o'>-</span> <span class='n'>x2</span><span class='o'>)</span> <span class='o'>/</span> <span class='mi'>8</span><span class='o'>);</span>
      <span class='k'>if</span> <span class='o'>(</span><span class='n'>y1</span> <span class='o'>&lt;=</span> <span class='n'>y2</span><span class='o'>)</span> <span class='o'>{</span>
          <span class='n'>y</span> <span class='o'>=</span> <span class='n'>y1</span> <span class='o'>+</span> <span class='mi'>3</span> <span class='o'>*</span> <span class='o'>((</span><span class='n'>y2</span> <span class='o'>-</span> <span class='n'>y1</span><span class='o'>)</span> <span class='o'>/</span> <span class='mi'>8</span><span class='o'>);</span>
      <span class='o'>}</span> <span class='k'>else</span> <span class='o'>{</span>
          <span class='n'>y</span> <span class='o'>=</span> <span class='n'>y2</span> <span class='o'>+</span> <span class='mi'>5</span> <span class='o'>*</span> <span class='o'>((</span><span class='n'>y1</span> <span class='o'>-</span> <span class='n'>y2</span><span class='o'>)</span> <span class='o'>/</span> <span class='mi'>8</span><span class='o'>);</span>
      <span class='o'>}</span>
    <span class='o'>}</span>
    <span class='k'>return</span> <span class='k'>new</span> <span class='nf'>Point</span><span class='o'>(</span><span class='n'>x</span><span class='o'>,</span> <span class='n'>y</span><span class='o'>);</span>
  <span class='o'>}</span>
</code></pre>
</div>
<p>The line direction elements are declared as attributes in the ToolBar class.</p>

<p><strong>Code 08-09.13</strong>: Line direction elements as attributes.</p>
<div class='highlight'><pre><code class='java'><span class='kd'>class</span> <span class='nc'>ToolBar</span> <span class='o'>{</span>
  <span class='err'>…</span>
  <span class='n'>LabelElement</span> <span class='n'>line12Box1Label</span><span class='o'>;</span>
  <span class='n'>LabelElement</span> <span class='n'>line12Box2Label</span><span class='o'>;</span>
  <span class='n'>InputElement</span> <span class='n'>line12MinInput</span><span class='o'>;</span>
  <span class='n'>InputElement</span> <span class='n'>line12MaxInput</span><span class='o'>;</span>
  <span class='n'>InputElement</span> <span class='n'>line12IdCheckbox</span><span class='o'>;</span>
  <span class='n'>InputElement</span> <span class='n'>line12NameInput</span><span class='o'>;</span>
  
  <span class='n'>LabelElement</span> <span class='n'>line21Box2Label</span><span class='o'>;</span>
  <span class='n'>LabelElement</span> <span class='n'>line21Box1Label</span><span class='o'>;</span>
  <span class='n'>InputElement</span> <span class='n'>line21MinInput</span><span class='o'>;</span>
  <span class='n'>InputElement</span> <span class='n'>line21MaxInput</span><span class='o'>;</span>
  <span class='n'>InputElement</span> <span class='n'>line21IdCheckbox</span><span class='o'>;</span>
  <span class='n'>InputElement</span> <span class='n'>line21NameInput</span><span class='o'>;</span>
  
  <span class='n'>ButtonElement</span> <span class='n'>getLineButton</span><span class='o'>;</span>
  <span class='n'>ButtonElement</span> <span class='n'>setLineButton</span><span class='o'>;</span>
</code></pre>
</div>
<p>The line direction attributes are initialized in the constructor of the ToolBar class.</p>

<p><strong>Code 08-09.14</strong>: Initialization of the line direction attributes.</p>
<div class='highlight'><pre><code class='java'>    <span class='n'>line12Box1Label</span> <span class='o'>=</span> <span class='n'>document</span><span class='o'>.</span><span class='na'>query</span><span class='o'>(</span><span class='err'>&#39;#</span><span class='n'>line12Box1</span><span class='err'>&#39;</span><span class='o'>);</span>
    <span class='n'>line12Box2Label</span> <span class='o'>=</span> <span class='n'>document</span><span class='o'>.</span><span class='na'>query</span><span class='o'>(</span><span class='err'>&#39;#</span><span class='n'>line12Box2</span><span class='err'>&#39;</span><span class='o'>);</span>
    <span class='n'>line12MinInput</span> <span class='o'>=</span> <span class='n'>document</span><span class='o'>.</span><span class='na'>query</span><span class='o'>(</span><span class='err'>&#39;#</span><span class='n'>line12Min</span><span class='err'>&#39;</span><span class='o'>);</span>
    <span class='n'>line12MaxInput</span> <span class='o'>=</span> <span class='n'>document</span><span class='o'>.</span><span class='na'>query</span><span class='o'>(</span><span class='err'>&#39;#</span><span class='n'>line12Max</span><span class='err'>&#39;</span><span class='o'>);</span>
    <span class='n'>line12IdCheckbox</span> <span class='o'>=</span> <span class='n'>document</span><span class='o'>.</span><span class='na'>query</span><span class='o'>(</span><span class='err'>&#39;#</span><span class='n'>line12Id</span><span class='err'>&#39;</span><span class='o'>);</span>
    <span class='n'>line12NameInput</span> <span class='o'>=</span> <span class='n'>document</span><span class='o'>.</span><span class='na'>query</span><span class='o'>(</span><span class='err'>&#39;#</span><span class='n'>line12Name</span><span class='err'>&#39;</span><span class='o'>);</span>
    
    <span class='n'>line21Box2Label</span> <span class='o'>=</span> <span class='n'>document</span><span class='o'>.</span><span class='na'>query</span><span class='o'>(</span><span class='err'>&#39;#</span><span class='n'>line21Box2</span><span class='err'>&#39;</span><span class='o'>);</span>
    <span class='n'>line21Box1Label</span> <span class='o'>=</span> <span class='n'>document</span><span class='o'>.</span><span class='na'>query</span><span class='o'>(</span><span class='err'>&#39;#</span><span class='n'>line21Box1</span><span class='err'>&#39;</span><span class='o'>);</span>
    <span class='n'>line21MinInput</span> <span class='o'>=</span> <span class='n'>document</span><span class='o'>.</span><span class='na'>query</span><span class='o'>(</span><span class='err'>&#39;#</span><span class='n'>line21Min</span><span class='err'>&#39;</span><span class='o'>);</span>
    <span class='n'>line21MaxInput</span> <span class='o'>=</span> <span class='n'>document</span><span class='o'>.</span><span class='na'>query</span><span class='o'>(</span><span class='err'>&#39;#</span><span class='n'>line21Max</span><span class='err'>&#39;</span><span class='o'>);</span>
    <span class='n'>line21IdCheckbox</span> <span class='o'>=</span> <span class='n'>document</span><span class='o'>.</span><span class='na'>query</span><span class='o'>(</span><span class='err'>&#39;#</span><span class='n'>line21Id</span><span class='err'>&#39;</span><span class='o'>);</span>
    <span class='n'>line21NameInput</span> <span class='o'>=</span> <span class='n'>document</span><span class='o'>.</span><span class='na'>query</span><span class='o'>(</span><span class='err'>&#39;#</span><span class='n'>line21Name</span><span class='err'>&#39;</span><span class='o'>);</span>
</code></pre>
</div>
<p>The get line button element reacts in the constructor of the ToolBar class to the click event by obtaining the last selected line.</p>

<p><strong>Code 08-09.15</strong>: Getting the last selected line.</p>
<div class='highlight'><pre><code class='java'>    <span class='n'>getLineButton</span> <span class='o'>=</span> <span class='n'>document</span><span class='o'>.</span><span class='na'>query</span><span class='o'>(</span><span class='err'>&#39;#</span><span class='n'>getLine</span><span class='err'>&#39;</span><span class='o'>);</span>
    <span class='n'>getLineButton</span><span class='o'>.</span><span class='na'>on</span><span class='o'>.</span><span class='na'>click</span><span class='o'>.</span><span class='na'>add</span><span class='o'>((</span><span class='n'>MouseEvent</span> <span class='n'>e</span><span class='o'>)</span> <span class='o'>{</span>
      <span class='n'>Line</span> <span class='n'>line</span> <span class='o'>=</span> <span class='n'>board</span><span class='o'>.</span><span class='na'>lastLineSelected</span><span class='o'>;</span>
      <span class='k'>if</span> <span class='o'>(</span><span class='n'>line</span> <span class='o'>!=</span> <span class='kc'>null</span><span class='o'>)</span> <span class='o'>{</span>
        <span class='n'>line12Box1Label</span><span class='o'>.</span><span class='na'>text</span> <span class='o'>=</span> <span class='n'>line</span><span class='o'>.</span><span class='na'>box1</span><span class='o'>.</span><span class='na'>title</span><span class='o'>;</span>
        <span class='n'>line12Box2Label</span><span class='o'>.</span><span class='na'>text</span> <span class='o'>=</span> <span class='n'>line</span><span class='o'>.</span><span class='na'>box2</span><span class='o'>.</span><span class='na'>title</span><span class='o'>;</span>
        <span class='n'>line12MinInput</span><span class='o'>.</span><span class='na'>value</span> <span class='o'>=</span> <span class='n'>line</span><span class='o'>.</span><span class='na'>box1box2Min</span><span class='o'>;</span>
        <span class='n'>line12MaxInput</span><span class='o'>.</span><span class='na'>value</span> <span class='o'>=</span> <span class='n'>line</span><span class='o'>.</span><span class='na'>box1box2Max</span><span class='o'>;</span>
        <span class='n'>line12IdCheckbox</span><span class='o'>.</span><span class='na'>checked</span> <span class='o'>=</span> <span class='n'>line</span><span class='o'>.</span><span class='na'>box1box2Id</span><span class='o'>;</span>
        <span class='n'>line12NameInput</span><span class='o'>.</span><span class='na'>value</span> <span class='o'>=</span> <span class='n'>line</span><span class='o'>.</span><span class='na'>box1box2Name</span><span class='o'>;</span>
        
        <span class='n'>line21Box2Label</span><span class='o'>.</span><span class='na'>text</span> <span class='o'>=</span> <span class='n'>line</span><span class='o'>.</span><span class='na'>box2</span><span class='o'>.</span><span class='na'>title</span><span class='o'>;</span>
        <span class='n'>line21Box1Label</span><span class='o'>.</span><span class='na'>text</span> <span class='o'>=</span> <span class='n'>line</span><span class='o'>.</span><span class='na'>box1</span><span class='o'>.</span><span class='na'>title</span><span class='o'>;</span>
        <span class='n'>line21MinInput</span><span class='o'>.</span><span class='na'>value</span> <span class='o'>=</span> <span class='n'>line</span><span class='o'>.</span><span class='na'>box2box1Min</span><span class='o'>;</span>
        <span class='n'>line21MaxInput</span><span class='o'>.</span><span class='na'>value</span> <span class='o'>=</span> <span class='n'>line</span><span class='o'>.</span><span class='na'>box2box1Max</span><span class='o'>;</span>
        <span class='n'>line21IdCheckbox</span><span class='o'>.</span><span class='na'>checked</span> <span class='o'>=</span> <span class='n'>line</span><span class='o'>.</span><span class='na'>box2box1Id</span><span class='o'>;</span>
        <span class='n'>line21NameInput</span><span class='o'>.</span><span class='na'>value</span> <span class='o'>=</span> <span class='n'>line</span><span class='o'>.</span><span class='na'>box2box1Name</span><span class='o'>;</span>
      <span class='o'>}</span>
    <span class='o'>});</span>
</code></pre>
</div>
<p>The set line button element reacts in the constructor of the ToolBar class to the click event by accepting changes of the last selected line.</p>

<p><strong>Code 08-09.16</strong>: Accepting changes of the last selected line.</p>
<div class='highlight'><pre><code class='java'>    <span class='n'>setLineButton</span> <span class='o'>=</span> <span class='n'>document</span><span class='o'>.</span><span class='na'>query</span><span class='o'>(</span><span class='err'>&#39;#</span><span class='n'>setLine</span><span class='err'>&#39;</span><span class='o'>);</span>
    <span class='n'>setLineButton</span><span class='o'>.</span><span class='na'>on</span><span class='o'>.</span><span class='na'>click</span><span class='o'>.</span><span class='na'>add</span><span class='o'>((</span><span class='n'>MouseEvent</span> <span class='n'>e</span><span class='o'>)</span> <span class='o'>{</span>
      <span class='n'>Line</span> <span class='n'>line</span> <span class='o'>=</span> <span class='n'>board</span><span class='o'>.</span><span class='na'>lastLineSelected</span><span class='o'>;</span>
      <span class='k'>if</span> <span class='o'>(</span><span class='n'>line</span> <span class='o'>!=</span> <span class='kc'>null</span><span class='o'>)</span> <span class='o'>{</span>
        <span class='n'>line</span><span class='o'>.</span><span class='na'>box1box2Min</span> <span class='o'>=</span> <span class='n'>line12MinInput</span><span class='o'>.</span><span class='na'>value</span><span class='o'>.</span><span class='na'>trim</span><span class='o'>();</span>
        <span class='n'>line</span><span class='o'>.</span><span class='na'>box1box2Max</span> <span class='o'>=</span> <span class='n'>line12MaxInput</span><span class='o'>.</span><span class='na'>value</span><span class='o'>.</span><span class='na'>trim</span><span class='o'>();</span>
        <span class='k'>if</span> <span class='o'>(</span><span class='n'>line</span><span class='o'>.</span><span class='na'>box1box2Min</span> <span class='o'>==</span> <span class='sc'>&#39;1&#39;</span> <span class='o'>&amp;&amp;</span> <span class='n'>line</span><span class='o'>.</span><span class='na'>box1box2Max</span> <span class='o'>==</span> <span class='sc'>&#39;1&#39;</span><span class='o'>)</span> <span class='o'>{</span>
          <span class='n'>line</span><span class='o'>.</span><span class='na'>box1box2Id</span> <span class='o'>=</span> <span class='n'>line12IdCheckbox</span><span class='o'>.</span><span class='na'>checked</span><span class='o'>;</span>
        <span class='o'>}</span> <span class='k'>else</span> <span class='o'>{</span>
          <span class='n'>line12IdCheckbox</span><span class='o'>.</span><span class='na'>checked</span> <span class='o'>=</span> <span class='kc'>false</span><span class='o'>;</span>
          <span class='n'>line</span><span class='o'>.</span><span class='na'>box1box2Id</span> <span class='o'>=</span> <span class='kc'>false</span><span class='o'>;</span>
        <span class='o'>}</span>
        <span class='n'>line</span><span class='o'>.</span><span class='na'>box1box2Name</span> <span class='o'>=</span> <span class='n'>line12NameInput</span><span class='o'>.</span><span class='na'>value</span><span class='o'>.</span><span class='na'>trim</span><span class='o'>();</span>
        
        <span class='n'>line</span><span class='o'>.</span><span class='na'>box2box1Min</span> <span class='o'>=</span> <span class='n'>line21MinInput</span><span class='o'>.</span><span class='na'>value</span><span class='o'>.</span><span class='na'>trim</span><span class='o'>();</span>
        <span class='n'>line</span><span class='o'>.</span><span class='na'>box2box1Max</span> <span class='o'>=</span> <span class='n'>line21MaxInput</span><span class='o'>.</span><span class='na'>value</span><span class='o'>.</span><span class='na'>trim</span><span class='o'>();</span>
        <span class='k'>if</span> <span class='o'>(</span><span class='n'>line</span><span class='o'>.</span><span class='na'>box2box1Min</span> <span class='o'>==</span> <span class='sc'>&#39;1&#39;</span> <span class='o'>&amp;&amp;</span> <span class='n'>line</span><span class='o'>.</span><span class='na'>box2box1Max</span> <span class='o'>==</span> <span class='sc'>&#39;1&#39;</span><span class='o'>)</span> <span class='o'>{</span>
          <span class='n'>line</span><span class='o'>.</span><span class='na'>box2box1Id</span> <span class='o'>=</span> <span class='n'>line21IdCheckbox</span><span class='o'>.</span><span class='na'>checked</span><span class='o'>;</span>
        <span class='o'>}</span> <span class='k'>else</span> <span class='o'>{</span>
          <span class='n'>line21IdCheckbox</span><span class='o'>.</span><span class='na'>checked</span> <span class='o'>=</span> <span class='kc'>false</span><span class='o'>;</span>
          <span class='n'>line</span><span class='o'>.</span><span class='na'>box2box1Id</span> <span class='o'>=</span> <span class='kc'>false</span><span class='o'>;</span>
        <span class='o'>}</span>  
        <span class='n'>line</span><span class='o'>.</span><span class='na'>box2box1Name</span> <span class='o'>=</span> <span class='n'>line21NameInput</span><span class='o'>.</span><span class='na'>value</span><span class='o'>.</span><span class='na'>trim</span><span class='o'>();</span>
      <span class='o'>}</span>
    <span class='o'>});</span>
</code></pre>
</div>
<p>The line elements have their HTML representation in the mb.html file.</p>

<p><strong>Code 08-09.17</strong>: Tool bar section with line elements.</p>
<div class='highlight'><pre><code class='html'>    <span class='nt'>&lt;section&gt;</span> 
      <span class='nt'>&lt;canvas</span> <span class='na'>id=</span><span class='s'>&quot;canvas&quot;</span> <span class='na'>width=</span><span class='s'>&quot;990&quot;</span> <span class='na'>height=</span><span class='s'>&quot;560&quot;</span><span class='nt'>&gt;</span>
        Canvas is not supported in your browser.
      <span class='nt'>&lt;/canvas&gt;</span>
      <span class='nt'>&lt;footer&gt;</span>
        …
        <span class='nt'>&lt;br/&gt;&lt;br/&gt;</span>       
        <span class='nt'>&lt;label</span> <span class='na'>id=</span><span class='s'>&quot;line12Box1&quot;</span><span class='nt'>&gt;</span>Box1<span class='nt'>&lt;/label&gt;</span> -&gt;
        <span class='nt'>&lt;label</span> <span class='na'>id=</span><span class='s'>&quot;line12Box2&quot;</span><span class='nt'>&gt;</span>Box2<span class='nt'>&lt;/label&gt;</span>
        <span class='nt'>&lt;input</span> <span class='na'>type=</span><span class='s'>&quot;text&quot;</span> <span class='na'>id=</span><span class='s'>&quot;line12Min&quot;</span> <span class='na'>size=</span><span class='s'>&quot;1&quot;</span><span class='nt'>/&gt;</span> ..
        <span class='nt'>&lt;input</span> <span class='na'>type=</span><span class='s'>&quot;text&quot;</span> <span class='na'>id=</span><span class='s'>&quot;line12Max&quot;</span> <span class='na'>size=</span><span class='s'>&quot;1&quot;</span><span class='nt'>/&gt;</span>
        <span class='nt'>&lt;label</span> <span class='na'>for=</span><span class='s'>&quot;line12Id&quot;</span><span class='nt'>&gt;</span>Id<span class='nt'>&lt;/label&gt;</span>
        <span class='nt'>&lt;input</span> <span class='na'>type=</span><span class='s'>&quot;checkbox&quot;</span> <span class='na'>id=</span><span class='s'>&quot;line12Id&quot;</span><span class='nt'>/&gt;</span>
        <span class='nt'>&lt;label</span> <span class='na'>for=</span><span class='s'>&quot;line12Name&quot;</span><span class='nt'>&gt;</span>Name<span class='nt'>&lt;/label&gt;</span>
        <span class='nt'>&lt;input</span> <span class='na'>type=</span><span class='s'>&quot;text&quot;</span> <span class='na'>id=</span><span class='s'>&quot;line12Name&quot;</span><span class='nt'>/&gt;</span> |
        <span class='nt'>&lt;button</span> <span class='na'>id=</span><span class='s'>&quot;getLine&quot;</span><span class='nt'>&gt;</span>Get<span class='nt'>&lt;/button&gt;</span>
        <span class='nt'>&lt;br/&gt;</span>
        <span class='nt'>&lt;label</span> <span class='na'>id=</span><span class='s'>&quot;line21Box2&quot;</span><span class='nt'>&gt;</span>Box2<span class='nt'>&lt;/label&gt;</span> -&gt;
        <span class='nt'>&lt;label</span> <span class='na'>id=</span><span class='s'>&quot;line21Box1&quot;</span><span class='nt'>&gt;</span>Box1<span class='nt'>&lt;/label&gt;</span>
        <span class='nt'>&lt;input</span> <span class='na'>type=</span><span class='s'>&quot;text&quot;</span> <span class='na'>id=</span><span class='s'>&quot;line21Min&quot;</span> <span class='na'>size=</span><span class='s'>&quot;1&quot;</span><span class='nt'>/&gt;</span> ..
        <span class='nt'>&lt;input</span> <span class='na'>type=</span><span class='s'>&quot;text&quot;</span> <span class='na'>id=</span><span class='s'>&quot;line21Max&quot;</span> <span class='na'>size=</span><span class='s'>&quot;1&quot;</span><span class='nt'>/&gt;</span>
        <span class='nt'>&lt;label</span> <span class='na'>for=</span><span class='s'>&quot;line21Id&quot;</span><span class='nt'>&gt;</span>Id<span class='nt'>&lt;/label&gt;</span>
        <span class='nt'>&lt;input</span> <span class='na'>type=</span><span class='s'>&quot;checkbox&quot;</span> <span class='na'>id=</span><span class='s'>&quot;line21Id&quot;</span><span class='nt'>/&gt;</span>
        <span class='nt'>&lt;label</span> <span class='na'>for=</span><span class='s'>&quot;line21Name&quot;</span><span class='nt'>&gt;</span>Name<span class='nt'>&lt;/label&gt;</span>
        <span class='nt'>&lt;input</span> <span class='na'>type=</span><span class='s'>&quot;text&quot;</span> <span class='na'>id=</span><span class='s'>&quot;line21Name&quot;</span><span class='nt'>/&gt;</span> |   
        <span class='nt'>&lt;button</span> <span class='na'>id=</span><span class='s'>&quot;setLine&quot;</span><span class='nt'>&gt;</span>Set<span class='nt'>&lt;/button&gt;</span>
      <span class='nt'>&lt;/footer&gt;</span>
      …
    <span class='nt'>&lt;/section&gt;</span>
</code></pre>
</div>
<p>In the page.css file, the width property of the body selector is updated to 1000 pixels.</p>

<p><strong>Code 08-09.18</strong>: Width of 1000 pixels.</p>
<div class='highlight'><pre><code class='css'>  <span class='nt'>body</span> <span class='p'>{</span>
    <span class='k'>font-family</span><span class='o'>:</span> <span class='n'>verdana</span><span class='o'>,</span> <span class='n'>arial</span><span class='o'>,</span> <span class='n'>helvetica</span><span class='o'>,</span> <span class='k'>sans-serif</span><span class='p'>;</span>
    <span class='k'>font-size</span><span class='o'>:</span> <span class='m'>16px</span><span class='p'>;</span>
    <span class='k'>background</span><span class='o'>:</span> <span class='m'>#d9ece2</span><span class='p'>;</span>
    <span class='k'>width</span><span class='o'>:</span> <span class='m'>1000px</span><span class='p'>;</span>
    <span class='k'>margin-left</span><span class='o'>:</span> <span class='k'>auto</span><span class='p'>;</span>
    <span class='k'>margin-right</span><span class='o'>:</span> <span class='k'>auto</span><span class='p'>;</span>
    <span class='k'>padding</span><span class='o'>:</span><span class='m'>10px</span><span class='p'>;</span> 
  <span class='p'>}</span>
</code></pre>
</div>
<p>The new width provides a better display of the tool bar in Figure 08-09.04. The figure shows the Order Items model.</p>

<p><img src='/img/s08s09/Orders.png' alt='Alt Figure 08-09.04: Order items model' /></p>

<p><strong>Figure 08-09.04</strong>: Order items model.</p>

<p>In the Board class, the saveAsPng method finds the model image element in the document and converts the canvas object to the PNG image.</p>

<p><strong>Code 08-09.19</strong>: Saving a model as a png image element.</p>
<div class='highlight'><pre><code class='java'>  <span class='kt'>void</span> <span class='nf'>saveAsPng</span><span class='o'>()</span> <span class='o'>{</span>
    <span class='n'>ImageElement</span> <span class='n'>modelImage</span> <span class='o'>=</span> <span class='n'>document</span><span class='o'>.</span><span class='na'>query</span><span class='o'>(</span><span class='err'>&#39;#</span><span class='n'>modelImage</span><span class='err'>&#39;</span><span class='o'>);</span>
    <span class='n'>modelImage</span><span class='o'>.</span><span class='na'>src</span> <span class='o'>=</span> <span class='n'>canvas</span><span class='o'>.</span><span class='na'>toDataURL</span><span class='o'>(</span><span class='s'>&quot;image/png&quot;</span><span class='o'>);</span>
  <span class='o'>}</span>
</code></pre>
</div>
<p>The image object is represented in HTML as the img element. The modelImage id is used to connect the image object in Dart with the image element in HTML.</p>

<p><strong>Code 08-09.20</strong>: Model displayed as an image in the Your Model section of the Web page.</p>
<div class='highlight'><pre><code class='html'>    <span class='nt'>&lt;section&gt;</span>
      <span class='nt'>&lt;header&gt;</span>
        <span class='nt'>&lt;h3&gt;</span>Your Model<span class='nt'>&lt;/h3&gt;</span>
      <span class='nt'>&lt;/header&gt;</span>
      <span class='nt'>&lt;p&gt;</span>
        In the File menu, save your model as a .png image:
      <span class='nt'>&lt;/p&gt;</span>
      <span class='nt'>&lt;img</span> <span class='na'>alt=</span><span class='s'>&quot;Your model saved as .png.&quot;</span> <span class='na'>id=</span><span class='s'>&quot;modelImage&quot;</span><span class='nt'>/&gt;</span>
      <span class='nt'>&lt;p&gt;</span>
        You may save the model image as the model.png file in the mb/img directory.
      <span class='nt'>&lt;/p&gt;</span>
    <span class='nt'>&lt;/section&gt;</span>
</code></pre>
</div>
<p>The button element attribute is used in the MenuBar class to provide a way for a user to save a model as a PNG image.</p>

<p><strong>Code 08-09.21</strong>: File menu item as the button element attribute.</p>
<div class='highlight'><pre><code class='java'><span class='kd'>class</span> <span class='nc'>MenuBar</span> <span class='o'>{</span>
  <span class='err'>…</span>
  <span class='c1'>// File</span>
  <span class='n'>ButtonElement</span> <span class='n'>saveAsPngButton</span><span class='o'>;</span>
</code></pre>
</div>
<p>The button element attribute is initialized in the constructor of the MenuBar class.</p>

<p><strong>Code 08-09.22</strong>: Initializing the save as button.</p>
<div class='highlight'><pre><code class='java'>  <span class='n'>MenuBar</span><span class='o'>(</span><span class='k'>this</span><span class='o'>.</span><span class='na'>board</span><span class='o'>)</span> <span class='o'>{</span>
    <span class='n'>saveAsPngButton</span> <span class='o'>=</span> <span class='n'>document</span><span class='o'>.</span><span class='na'>query</span><span class='o'>(</span><span class='err'>&#39;#</span><span class='n'>save</span><span class='o'>-</span><span class='n'>as</span><span class='o'>-</span><span class='n'>png</span><span class='err'>&#39;</span><span class='o'>);</span>
</code></pre>
</div>
<p>After the initialization of the button element attribute, the click event is defined.</p>

<p><strong>Code 08-09.23</strong>: Reacting to the button click.</p>
<div class='highlight'><pre><code class='java'>    <span class='n'>saveAsPngButton</span><span class='o'>.</span><span class='na'>on</span><span class='o'>.</span><span class='na'>click</span><span class='o'>.</span><span class='na'>add</span><span class='o'>((</span><span class='n'>MouseEvent</span> <span class='n'>e</span><span class='o'>)</span> <span class='o'>{</span>
      <span class='n'>board</span><span class='o'>.</span><span class='na'>saveAsPng</span><span class='o'>();</span>
    <span class='o'>});</span>
</code></pre>
</div>
<p>A model may be saved as an image file by using the File menu. The model appears first within the Web page (Figure 08-09.05) where it can be saved by using the right button of the mouse.</p>

<p><img src='/img/s08s09/PlaceForModel.png' alt='Alt Figure 08-09.05: Place where a model will appear after the save' /></p>

<p><strong>Figure 08-09.05</strong>: Place where a model will appear after the save.</p>

<p>In the mb.html file, the button element is added as the File menu item.</p>

<p><strong>Code 08-09.24</strong>: File menu item.</p>
<div class='highlight'><pre><code class='html'>       <span class='nt'>&lt;li&gt;</span>File
         <span class='nt'>&lt;ul&gt;</span>
           <span class='nt'>&lt;li&gt;</span>
             <span class='nt'>&lt;button</span> <span class='na'>id=</span><span class='s'>&quot;save-as-png&quot;</span><span class='nt'>&gt;</span>
               Save as .png
             <span class='nt'>&lt;/button&gt;</span>
           <span class='nt'>&lt;/li&gt;</span>
         <span class='nt'>&lt;/ul&gt;</span>   
       <span class='nt'>&lt;/li&gt;</span>
</code></pre>
</div>
<p>There is also the About menu that is defined only in HTML. The About menu was introduced in one of the earlier spirals.</p>

<p><strong>Code 08-09.25</strong>: About menu.</p>
<div class='highlight'><pre><code class='html'>       <span class='nt'>&lt;li&gt;</span>About 
         <span class='nt'>&lt;ul&gt;</span>
           <span class='nt'>&lt;li&gt;</span>Magic Boxes in <span class='nt'>&lt;a</span> <span class='na'>href=</span><span class='s'>&quot;http://www.dart.org/&quot;</span><span class='nt'>&gt;</span>Dart<span class='nt'>&lt;/a&gt;&lt;/li&gt;</span>
           <span class='nt'>&lt;li&gt;</span>Spiral 09<span class='nt'>&lt;/li&gt;</span>
           <span class='nt'>&lt;li&gt;</span>2012-01-02<span class='nt'>&lt;/li&gt;</span>
           <span class='nt'>&lt;li&gt;</span>Dzenan Ridjanovic<span class='nt'>&lt;/li&gt;</span>
           <span class='nt'>&lt;li&gt;&lt;img</span> <span class='na'>src=</span><span class='s'>&quot;img/ondart0.png&quot;</span><span class='nt'>/&gt;&lt;/li&gt;</span>
         <span class='nt'>&lt;/ul&gt;</span>   
       <span class='nt'>&lt;/li&gt;</span>
</code></pre>
</div>
<p>There are changes related to box items in the ToolBar class that should have been reported earlier. After an item of the last selected box is obtained based on its entered name, a value of the item option element is updated to a category of the item.</p>

<p><strong>Code 08-09.26</strong>: Getting the item.</p>
<div class='highlight'><pre><code class='java'>    <span class='n'>getItemButton</span> <span class='o'>=</span> <span class='n'>document</span><span class='o'>.</span><span class='na'>query</span><span class='o'>(</span><span class='err'>&#39;#</span><span class='n'>getItem</span><span class='err'>&#39;</span><span class='o'>);</span>
    <span class='n'>getItemButton</span><span class='o'>.</span><span class='na'>on</span><span class='o'>.</span><span class='na'>click</span><span class='o'>.</span><span class='na'>add</span><span class='o'>((</span><span class='n'>MouseEvent</span> <span class='n'>e</span><span class='o'>)</span> <span class='o'>{</span>
      <span class='n'>Box</span> <span class='n'>box</span> <span class='o'>=</span> <span class='n'>board</span><span class='o'>.</span><span class='na'>lastBoxSelected</span><span class='o'>;</span>
      <span class='k'>if</span> <span class='o'>(</span><span class='n'>box</span> <span class='o'>!=</span> <span class='kc'>null</span><span class='o'>)</span> <span class='o'>{</span>
        <span class='n'>Item</span> <span class='n'>item</span> <span class='o'>=</span> <span class='n'>box</span><span class='o'>.</span><span class='na'>findItem</span><span class='o'>(</span><span class='n'>itemNameInput</span><span class='o'>.</span><span class='na'>value</span><span class='o'>);</span>
        <span class='k'>if</span> <span class='o'>(</span><span class='n'>item</span> <span class='o'>!=</span> <span class='kc'>null</span><span class='o'>)</span> <span class='o'>{</span>
          <span class='n'>currentItem</span> <span class='o'>=</span> <span class='n'>item</span><span class='o'>;</span>
          <span class='n'>itemNameInput</span><span class='o'>.</span><span class='na'>value</span> <span class='o'>=</span> <span class='n'>item</span><span class='o'>.</span><span class='na'>name</span><span class='o'>;</span>
          <span class='n'>itemOption</span><span class='o'>.</span><span class='na'>value</span> <span class='o'>=</span> <span class='n'>item</span><span class='o'>.</span><span class='na'>category</span><span class='o'>;</span>
          <span class='n'>itemNameInput</span><span class='o'>.</span><span class='na'>select</span><span class='o'>();</span>
        <span class='o'>}</span> <span class='k'>else</span> <span class='o'>{</span>
          <span class='n'>currentItem</span> <span class='o'>=</span> <span class='kc'>null</span><span class='o'>;</span>
        <span class='o'>}</span>
      <span class='o'>}</span>
    <span class='o'>});</span>
</code></pre>
</div>
<p>After changing the item of the last selected box, the category of the current item is updated.</p>

<p><strong>Code 08-09.27</strong>: Setting the item.</p>
<div class='highlight'><pre><code class='java'>    <span class='n'>setItemButton</span> <span class='o'>=</span> <span class='n'>document</span><span class='o'>.</span><span class='na'>query</span><span class='o'>(</span><span class='err'>&#39;#</span><span class='n'>setItem</span><span class='err'>&#39;</span><span class='o'>);</span>
    <span class='n'>setItemButton</span><span class='o'>.</span><span class='na'>on</span><span class='o'>.</span><span class='na'>click</span><span class='o'>.</span><span class='na'>add</span><span class='o'>((</span><span class='n'>MouseEvent</span> <span class='n'>e</span><span class='o'>)</span> <span class='o'>{</span>
      <span class='n'>Box</span> <span class='n'>box</span> <span class='o'>=</span> <span class='n'>board</span><span class='o'>.</span><span class='na'>lastBoxSelected</span><span class='o'>;</span>
      <span class='k'>if</span> <span class='o'>(</span><span class='n'>box</span> <span class='o'>!=</span> <span class='kc'>null</span><span class='o'>)</span> <span class='o'>{</span>
        <span class='k'>if</span> <span class='o'>(</span><span class='n'>currentItem</span> <span class='o'>!=</span> <span class='kc'>null</span><span class='o'>)</span> <span class='o'>{</span>
          <span class='n'>currentItem</span><span class='o'>.</span><span class='na'>name</span> <span class='o'>=</span> <span class='n'>itemNameInput</span><span class='o'>.</span><span class='na'>value</span><span class='o'>;</span>
          <span class='n'>currentItem</span><span class='o'>.</span><span class='na'>category</span> <span class='o'>=</span> <span class='n'>itemOption</span><span class='o'>.</span><span class='na'>value</span><span class='o'>;</span>
          <span class='n'>itemNameInput</span><span class='o'>.</span><span class='na'>select</span><span class='o'>();</span>
        <span class='o'>}</span>
      <span class='o'>}</span>
    <span class='o'>});</span>
</code></pre>
</div>
<p>After removing the item of the last selected box, the value of the item option comes back to the attribute default value.</p>

<p><strong>Code 08-09.28</strong>: Removing the item.</p>
<div class='highlight'><pre><code class='java'>    <span class='n'>removeItemButton</span> <span class='o'>=</span> <span class='n'>document</span><span class='o'>.</span><span class='na'>query</span><span class='o'>(</span><span class='err'>&#39;#</span><span class='n'>removeItem</span><span class='err'>&#39;</span><span class='o'>);</span>
    <span class='n'>removeItemButton</span><span class='o'>.</span><span class='na'>on</span><span class='o'>.</span><span class='na'>click</span><span class='o'>.</span><span class='na'>add</span><span class='o'>((</span><span class='n'>MouseEvent</span> <span class='n'>e</span><span class='o'>)</span> <span class='o'>{</span>
      <span class='n'>Box</span> <span class='n'>box</span> <span class='o'>=</span> <span class='n'>board</span><span class='o'>.</span><span class='na'>lastBoxSelected</span><span class='o'>;</span>
      <span class='k'>if</span> <span class='o'>(</span><span class='n'>box</span> <span class='o'>!=</span> <span class='kc'>null</span><span class='o'>)</span> <span class='o'>{</span>
        <span class='k'>if</span> <span class='o'>(</span><span class='n'>currentItem</span> <span class='o'>!=</span> <span class='kc'>null</span><span class='o'>)</span> <span class='o'>{</span>
          <span class='k'>if</span> <span class='o'>(</span><span class='n'>box</span><span class='o'>.</span><span class='na'>removeItem</span><span class='o'>(</span><span class='n'>currentItem</span><span class='o'>))</span> <span class='o'>{</span>
            <span class='n'>currentItem</span> <span class='o'>=</span> <span class='kc'>null</span><span class='o'>;</span>
            <span class='n'>itemNameInput</span><span class='o'>.</span><span class='na'>value</span> <span class='o'>=</span> <span class='err'>&#39;&#39;</span><span class='o'>;</span>
            <span class='n'>itemOption</span><span class='o'>.</span><span class='na'>value</span> <span class='o'>=</span> <span class='err'>&#39;</span><span class='n'>attribute</span><span class='err'>&#39;</span><span class='o'>;</span>
          <span class='o'>}</span>
        <span class='o'>}</span>
      <span class='o'>}</span>
    <span class='o'>});</span>
</code></pre>
</div>
<p>In the Box class of Spiral 09, there are warnings in the getIntersectionPoint method: local variables x and y hide the x and y fields (attributes).</p>

<p><strong>Code 08-09.29</strong>: Local variables x and y have the same names as the x and y attributes.</p>
<div class='highlight'><pre><code class='java'>  <span class='n'>Point</span> <span class='nf'>getIntersectionPoint</span><span class='o'>(</span><span class='n'>Point</span> <span class='n'>lineBeginPoint</span><span class='o'>,</span> <span class='n'>Point</span> <span class='n'>lineEndPoint</span><span class='o'>)</span> <span class='o'>{</span>
    <span class='kt'>int</span> <span class='n'>x1</span> <span class='o'>=</span> <span class='n'>lineBeginPoint</span><span class='o'>.</span><span class='na'>x</span><span class='o'>;</span>
    <span class='kt'>int</span> <span class='n'>y1</span> <span class='o'>=</span> <span class='n'>lineBeginPoint</span><span class='o'>.</span><span class='na'>y</span><span class='o'>;</span>
    <span class='kt'>int</span> <span class='n'>x2</span> <span class='o'>=</span> <span class='n'>lineEndPoint</span><span class='o'>.</span><span class='na'>x</span><span class='o'>;</span>
    <span class='kt'>int</span> <span class='n'>y2</span> <span class='o'>=</span> <span class='n'>lineEndPoint</span><span class='o'>.</span><span class='na'>y</span><span class='o'>;</span>
    <span class='k'>if</span> <span class='o'>(</span><span class='n'>x2</span> <span class='o'>==</span> <span class='n'>x1</span><span class='o'>)</span> <span class='cm'>/* vertical line */</span>
      <span class='k'>return</span> <span class='k'>new</span> <span class='nf'>Point</span><span class='o'>(</span><span class='n'>x2</span><span class='o'>,</span> <span class='o'>(</span><span class='n'>y2</span> <span class='o'>&lt;</span> <span class='n'>y1</span> <span class='o'>?</span> <span class='k'>this</span><span class='o'>.</span><span class='na'>y</span> <span class='o'>:</span> <span class='k'>this</span><span class='o'>.</span><span class='na'>y</span> <span class='o'>+</span> <span class='k'>this</span><span class='o'>.</span><span class='na'>height</span><span class='o'>));</span>
    <span class='k'>if</span> <span class='o'>(</span><span class='n'>y2</span> <span class='o'>==</span> <span class='n'>y1</span><span class='o'>)</span> <span class='cm'>/* horizontal line */</span>
      <span class='k'>return</span> <span class='k'>new</span> <span class='nf'>Point</span><span class='o'>((</span><span class='n'>x2</span> <span class='o'>&lt;</span> <span class='n'>x1</span> <span class='o'>?</span> <span class='k'>this</span><span class='o'>.</span><span class='na'>x</span> <span class='o'>:</span> <span class='k'>this</span><span class='o'>.</span><span class='na'>x</span> <span class='o'>+</span> <span class='k'>this</span><span class='o'>.</span><span class='na'>width</span><span class='o'>),</span> <span class='n'>y2</span><span class='o'>);</span>

    <span class='kt'>double</span> <span class='n'>m</span> <span class='o'>=</span> <span class='o'>(</span><span class='n'>y2</span> <span class='o'>-</span> <span class='n'>y1</span><span class='o'>)</span> <span class='o'>/</span> <span class='o'>(</span><span class='n'>x2</span> <span class='o'>-</span> <span class='n'>x1</span><span class='o'>);</span>
    <span class='kt'>int</span> <span class='n'>x</span> <span class='o'>=</span> <span class='o'>(</span><span class='n'>x2</span> <span class='o'>&lt;</span> <span class='n'>x1</span> <span class='o'>?</span> <span class='k'>this</span><span class='o'>.</span><span class='na'>x</span> <span class='o'>:</span> <span class='k'>this</span><span class='o'>.</span><span class='na'>x</span> <span class='o'>+</span> <span class='k'>this</span><span class='o'>.</span><span class='na'>width</span><span class='o'>);</span>
    <span class='kt'>double</span> <span class='n'>fy</span> <span class='o'>=</span> <span class='n'>m</span> <span class='o'>*</span> <span class='o'>(</span><span class='n'>x</span> <span class='o'>-</span> <span class='n'>x2</span><span class='o'>)</span> <span class='o'>+</span> <span class='n'>y2</span><span class='o'>;</span>
    <span class='kt'>int</span> <span class='n'>y</span><span class='o'>;</span>
    <span class='cm'>/* float comparison, because fy may be bigger than the biggest integer */</span>
    <span class='k'>if</span> <span class='o'>(</span><span class='n'>fy</span> <span class='o'>&gt;=</span> <span class='k'>this</span><span class='o'>.</span><span class='na'>y</span> <span class='o'>&amp;&amp;</span> <span class='n'>fy</span> <span class='o'>&lt;=</span> <span class='k'>this</span><span class='o'>.</span><span class='na'>y</span> <span class='o'>+</span> <span class='k'>this</span><span class='o'>.</span><span class='na'>height</span><span class='o'>)</span> <span class='o'>{</span>
      <span class='n'>y</span> <span class='o'>=</span> <span class='n'>fy</span><span class='o'>.</span><span class='na'>toInt</span><span class='o'>();</span>
    <span class='o'>}</span> <span class='k'>else</span> <span class='o'>{</span>
      <span class='n'>y</span> <span class='o'>=</span> <span class='o'>(</span><span class='n'>y2</span> <span class='o'>&lt;</span> <span class='n'>y1</span> <span class='o'>?</span> <span class='k'>this</span><span class='o'>.</span><span class='na'>y</span> <span class='o'>:</span> <span class='k'>this</span><span class='o'>.</span><span class='na'>y</span> <span class='o'>+</span> <span class='k'>this</span><span class='o'>.</span><span class='na'>height</span><span class='o'>);</span>
      <span class='n'>x</span> <span class='o'>=</span> <span class='o'>((</span><span class='n'>fy</span> <span class='o'>-</span> <span class='n'>y2</span><span class='o'>)</span> <span class='o'>/</span> <span class='n'>m</span><span class='o'>).</span><span class='na'>toInt</span><span class='o'>()</span> <span class='o'>+</span> <span class='n'>x2</span><span class='o'>;</span>
    <span class='o'>}</span>
    <span class='k'>return</span> <span class='k'>new</span> <span class='nf'>Point</span><span class='o'>(</span><span class='n'>x</span><span class='o'>,</span> <span class='n'>y</span><span class='o'>);</span>
  <span class='o'>}</span>
</code></pre>
</div>
<p>After the local x and y variables are replaced by the new intersectionX and intersectionY variables, a problem is introduced. After creating two boxes with a line between them, moving one of the boxes jumps the box. Try to find out what the problem is?</p>

<p><strong>Code 08-09.30</strong>: Local variables intersectionX and intersectionY used.</p>
<div class='highlight'><pre><code class='java'>  <span class='n'>Point</span> <span class='nf'>getIntersectionPoint</span><span class='o'>(</span><span class='n'>Point</span> <span class='n'>lineBeginPoint</span><span class='o'>,</span> <span class='n'>Point</span> <span class='n'>lineEndPoint</span><span class='o'>)</span> <span class='o'>{</span>
    <span class='kt'>int</span> <span class='n'>x1</span> <span class='o'>=</span> <span class='n'>lineBeginPoint</span><span class='o'>.</span><span class='na'>x</span><span class='o'>;</span>
    <span class='kt'>int</span> <span class='n'>y1</span> <span class='o'>=</span> <span class='n'>lineBeginPoint</span><span class='o'>.</span><span class='na'>y</span><span class='o'>;</span>
    <span class='kt'>int</span> <span class='n'>x2</span> <span class='o'>=</span> <span class='n'>lineEndPoint</span><span class='o'>.</span><span class='na'>x</span><span class='o'>;</span>
    <span class='kt'>int</span> <span class='n'>y2</span> <span class='o'>=</span> <span class='n'>lineEndPoint</span><span class='o'>.</span><span class='na'>y</span><span class='o'>;</span>
    <span class='k'>if</span> <span class='o'>(</span><span class='n'>x2</span> <span class='o'>==</span> <span class='n'>x1</span><span class='o'>)</span> <span class='o'>{</span>
      <span class='cm'>/* vertical line */</span>
      <span class='k'>return</span> <span class='k'>new</span> <span class='nf'>Point</span><span class='o'>(</span><span class='n'>x2</span><span class='o'>,</span> <span class='o'>(</span><span class='n'>y2</span> <span class='o'>&lt;</span> <span class='n'>y1</span> <span class='o'>?</span> <span class='n'>y</span> <span class='o'>:</span> <span class='n'>y</span> <span class='o'>+</span> <span class='n'>height</span><span class='o'>));</span>
    <span class='o'>}</span> 
    <span class='k'>if</span> <span class='o'>(</span><span class='n'>y2</span> <span class='o'>==</span> <span class='n'>y1</span><span class='o'>)</span> <span class='o'>{</span>
      <span class='cm'>/* horizontal line */</span>
      <span class='k'>return</span> <span class='k'>new</span> <span class='nf'>Point</span><span class='o'>((</span><span class='n'>x2</span> <span class='o'>&lt;</span> <span class='n'>x1</span> <span class='o'>?</span> <span class='n'>x</span> <span class='o'>:</span> <span class='n'>x</span> <span class='o'>+</span> <span class='n'>width</span><span class='o'>),</span> <span class='n'>y2</span><span class='o'>);</span>
    <span class='o'>}</span> 
      
    <span class='kt'>double</span> <span class='n'>m</span> <span class='o'>=</span> <span class='o'>(</span><span class='n'>y2</span> <span class='o'>-</span> <span class='n'>y1</span><span class='o'>)</span> <span class='o'>/</span> <span class='o'>(</span><span class='n'>x2</span> <span class='o'>-</span> <span class='n'>x1</span><span class='o'>);</span>
    <span class='kt'>int</span> <span class='n'>intersectionX</span> <span class='o'>=</span> <span class='o'>(</span><span class='n'>x2</span> <span class='o'>&lt;</span> <span class='n'>x1</span> <span class='o'>?</span> <span class='n'>x</span> <span class='o'>:</span> <span class='n'>x</span> <span class='o'>+</span> <span class='n'>width</span><span class='o'>);</span>
    <span class='kt'>double</span> <span class='n'>fy</span> <span class='o'>=</span> <span class='n'>m</span> <span class='o'>*</span> <span class='o'>(</span><span class='n'>intersectionX</span> <span class='o'>-</span> <span class='n'>x2</span><span class='o'>)</span> <span class='o'>+</span> <span class='n'>y2</span><span class='o'>;</span>
    <span class='kt'>int</span> <span class='n'>intersectionY</span><span class='o'>;</span>
    <span class='cm'>/* float comparison, because fy may be bigger than the biggest integer */</span>
    <span class='k'>if</span> <span class='o'>(</span><span class='n'>fy</span> <span class='o'>&gt;=</span> <span class='n'>y</span> <span class='o'>&amp;&amp;</span> <span class='n'>fy</span> <span class='o'>&lt;=</span> <span class='n'>y</span> <span class='o'>+</span> <span class='n'>height</span><span class='o'>)</span> <span class='o'>{</span>
      <span class='n'>intersectionY</span> <span class='o'>=</span> <span class='n'>fy</span><span class='o'>.</span><span class='na'>toInt</span><span class='o'>();</span>
    <span class='o'>}</span> <span class='k'>else</span> <span class='o'>{</span>
      <span class='n'>y</span> <span class='o'>=</span> <span class='o'>(</span><span class='n'>y2</span> <span class='o'>&lt;</span> <span class='n'>y1</span> <span class='o'>?</span> <span class='n'>y</span> <span class='o'>:</span> <span class='n'>y</span> <span class='o'>+</span> <span class='n'>height</span><span class='o'>);</span>
      <span class='n'>x</span> <span class='o'>=</span> <span class='o'>((</span><span class='n'>fy</span> <span class='o'>-</span> <span class='n'>y2</span><span class='o'>)</span> <span class='o'>/</span> <span class='n'>m</span><span class='o'>).</span><span class='na'>toInt</span><span class='o'>()</span> <span class='o'>+</span> <span class='n'>x2</span><span class='o'>;</span>
    <span class='o'>}</span>
    <span class='k'>return</span> <span class='k'>new</span> <span class='nf'>Point</span><span class='o'>(</span><span class='n'>intersectionX</span><span class='o'>,</span> <span class='n'>intersectionY</span><span class='o'>);</span>
  <span class='o'>}</span>
</code></pre>
</div>
        </section>

        <section>
     
        </section>

        <footer>
          <a href="http://dzenanr.github.com/ondart.rss">
            <img src="/img/xml.gif" width=36 height=14 alt="RSS feed for this site" border=0>
          </a>
        </footer>

    </body>
</html>


